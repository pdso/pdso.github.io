<!DOCTYPE html><html lang="zh"><head><title>pd🤩 - iOS Developer</title><meta name="twitter:title" content="pd🤩 - iOS Developer"/><meta name="og:title" content="pd🤩 - iOS Developer"/><meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/pure-min.css" integrity="sha384-oAOxQR6DkCoMliIh8yFnu25d7Eq/PHS21PClpwjOTeU2jRSq11vu66rf90/cZr47" crossorigin="anonymous"/><link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/grids-responsive-min.css"/><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"/><link rel="stylesheet" href="/Pure/styles.css"/><link rel="stylesheet" href="/all.css"/><script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script></head><body><div id="layout" class="pure-g"><div><div class="pure-menu pure-menu-horizontal pure-u-1-1 top-header"><a class="pure-menu-heading" href="/">Just do it</a><ul class="pure-menu-list"><li class="pure-menu-item"><a class="pure-menu-link" href="/about">About</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/posts">Notes</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/life">Life</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/other">Other</a></li></ul></div></div><div class="sidebar pure-u-1 pure-u-md-1-4"><div class="header"><div id="layout" class="pure-g"><div class="author__avatar"><img src="https://avatars.githubusercontent.com/u/8196592?v=4"/></div><div class="pure-u-md-1-1 pure-u-3-4"><h1 class="brand-title">pd🤩</h1><h3 class="brand-tagline">iOS Developer</h3></div></div><div id="layout" class="pure-g"><div class="pure-u-md-1-1"><a href="https://en.wikipedia.org/wiki/Shenzhen"><i class="fas fa-map-marker-alt l-box social-icon"></i><a class="social-media" href="https://en.wikipedia.org/wiki/Shenzhen">深圳, 广东</a></a></div><div class="pure-u-md-1-1"><a href="mailto:alan.funs@gmail.com"><i class="fas fa-envelope-open-text l-box social-icon"></i><a class="social-media" href="mailto:alan.funs@gmail.com">Email</a></a></div><div class="pure-u-md-1-1"><a href="https://github.com/pdso"><i class="fab fa-github-square l-box social-icon"></i><a class="social-media" href="https://github.com/pdso">GitHub</a></a></div></div></div></div><div class="content pure-u-1 pure-u-md-3-5 pure-u-xl-6-10"><h2 class="post-title"><a href="/posts/2022-04-14-Xcode-Hot-Reloading">Xcode Hot Reloading</a></h2><div class="post-meta"><div class="post-date">April 14, 2022</div><div class="post-tags"><a class="post-category post-category-xcode tag variant-6" href="/tags/xcode">Xcode</a><a class="post-category post-category-swiftui tag variant-5" href="/tags/swiftui">SwiftUI</a></div></div><div class="post-description"><div><p>最近几年很少写原生的iOS程序，写的多的是 <code>React Native</code> 和<code> Flutter</code>，他们都支持Hot Reloading, 不用重新运行就能看到最新的UI效果。相比之下Xcode真的逊色很多，最近写SwiftUI尝试了一下Preview 功能，实在是太弱鸡了，Google了一下解决方案，还真有Xcode Hot Reloading。记录一下。</p><h1>Steps</h1><h2>参考文档</h2><p>github <a href="https://github.com/johnno1962/InjectionIII">InjectionIII</a> github <a href="https://github.com/krzysztofzablocki/Inject">Inject</a></p><h2>配置</h2><h3>InjectionIII配置</h3><ul><li>从AppStore下载 <a href="https://apps.apple.com/app/injectioniii/id1380446739">InjectionIII</a></li></ul><ul><li>安装后打开InjectionIII, 在桌面是看不到InjectoinIII窗口的，点击状态栏图标，选择Open Project,选择项目目录</li></ul><img src="/images/notes/injection_01.png" align=left/><ul><li>勾选File Watcher选项, 选择的项目会在OPen Recent中展示</li></ul><img src="/images/notes/injection_02.png" align=left/><h3>SwiftUI项目配置</h3><ul><li>打开工程，选择 File → Swift Packages → Add Package Dependency, 输入Inject查找, 添加package</li></ul><img src="/images/notes/injection_03.png" align=left/><ul><li>在工程所有的Target中设置 Other Linker Flag, 添加 -Xlinker -interposable</li></ul><img src="/images/notes/injection_04.png" align=left/><h3>代码设置</h3><ul><li>导入头文件</li><li>添加 @ObservedObject private var iO = Inject.observer 变量</li><li>在需要刷新的控件结尾调用.enableInjection()</li></ul><pre data-language="Swift"><code><span class="hljs-keyword">import</span> SwiftUI
<span class="hljs-keyword">import</span> Inject

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ContentView</span>: <span class="hljs-title">View</span> </span>{
  @<span class="hljs-type">ObservedObject</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> iO = <span class="hljs-type">Inject</span>.observer
  
    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span> {
        <span class="hljs-type">Text</span>(<span class="hljs-string">"Hello, !"</span>)
            .padding()
            .enableInjection()
    }
}
</code></pre><h3>Debug</h3><ul><li>运行代码看到以下输出就代码配置成功了</li></ul><pre data-language="markdown"><code>💉 InjectionIII connected /Demo/SwiftUI<span class="hljs-emphasis">_Widget/SwiftUI_</span>Widget.xcodeproj
💉 Watching files under /Demo/SwiftUI_Widget
💉 💉 ⚠️ Your project file seems to be in the Desktop or Documents folder and may prevent InjectionIII working as it has special permissions.
</code></pre><ul><li>修改后Ctrl+S 保存就能看到神奇的刷新效果了</li></ul><pre data-language="markdown"><code>💉 Compiling /Demo/SwiftUI<span class="hljs-emphasis">_Widget/SwiftUI_</span>Widget/ContentView.swift
💉 Loading .dylib ...
💉 Loaded .dylib - Ignore any duplicate class warning ⬆️
💉 Interposed 3 function references.
💉 Injected type #1 'SwiftUI_Widget.ContentView'
💉 Injected type #2 'SwiftUI<span class="hljs-emphasis">_Widget.ContentView_</span>Previews'
</code></pre><ul><li>这是SwiftUI的配置过程，其他工程可以参考官方的文档</li></ul></div></div><div><div id="gitalk-container"></div>  <script type="text/javascript">
     var gitalk = new Gitalk({
       clientID: 'b95d503a9717272f665d',
       clientSecret: 'a881d3da92d2a2bd0ca6d17e2465935444a32b5d',
       repo: 'pdso.github.io',
       owner: 'pdso',
       admin: ['pdso'],
       id: location.pathname,
       distractionFreeMode: true
     })
     gitalk.render('gitalk-container')
 </script></div></div><div class="footer pure-u-1"><div class="pure-u-1">© 2015-2022 pd🤩</div><div class="pure-u-1">Generated using <a href="https://github.com/johnsundell/publish">Publish</a></div></div></div></body></html>